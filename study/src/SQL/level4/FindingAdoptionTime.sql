-- 입양 시각 구하기(2)
-- 0부터 23까지 HOUR_BASE 가상 테이블 생성
WITH RECURSIVE HOUR_BASE AS (
    SELECT 0 AS HOUR
    UNION ALL
    SELECT HOUR+1 FROM HOUR_BASE WHERE HOUR < 23
)

SELECT HOUR_BASE.HOUR, COUNT(ANIMAL_INFO.HOUR) COUNT
FROM (
    SELECT HOUR(DATETIME) AS HOUR
    FROM ANIMAL_OUTS
) AS ANIMAL_INFO
NATURAL RIGHT OUTER JOIN HOUR_BASE
GROUP BY HOUR
ORDER BY HOUR